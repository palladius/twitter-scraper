<h1>🐦 Twitter ⛏️ Scraper</h1>

<div>
<p>
Graphs generated with <a href="https://chartkick.com/">chartkick ruby library</a>.. love it!
</p>

<%#= column_chart WordleTweet.group(:wordle_type).group_by_hour(:created_at).count,  stacked: true %>
<%= column_chart WordleTweet.group(:score).group_by_hour(:created_at).count,  stacked: true ,  download: true, 
    xtitle: "Hour", ytitle: "Tweets by score" 
%>


#WTweets per hour - volume
<%= column_chart WordleTweet.group(:wordle_incremental_day).group_by_day(:created_at).count.select{|incremday_and_date, cardinality| cardinality > 50 } ,
   label: "Tweets per hour" , download: true, 
    stacked: true,
    xtitle: "Day", ytitle: "Total Tweets" %>

Tweets per day
<%= line_chart Tweet.group_by_day(:twitter_created_at).count  %>
<%#= line_chart TwitterUser.group_by_day(:created_at).count  %>

<table border="0" style="width:100%;background-color:#EFF;" >
<tr>
  <td style="width:50%">
  WordleTweet by Type
    <%= pie_chart WordleTweet.group(:wordle_type).count ,  download: true %>
  <td style="width:50%">
    WordleTweet by IncDay (Top 10)
    <%#= column_chart WordleTweet.group(:wordle_incremental_day).count.select{|day, cardinality| cardinality > 150} %>
    <%= column_chart WordleTweet.group(:wordle_incremental_day).count.sort_by{|d,c| c}.last(10),
        xtitle: "Incremental Day (top 10)" ,
        ytitle: "Total WTweets",
        download: true
    %>
    
<tr>
  <td>WordleTweet by Score
    <%= column_chart WordleTweet.group(:score).count.select{|x| x>=1 && x<=6},  download: true %>
    Average moves: <b><%= WordleTweet.global_average_score.round(2) %></b>

  <td>Average score by type
  <%#= column_chart WordleTweet.group(:wordle_type).average(:score) %>
  <%= column_chart WordleTweet.group(:wordle_type).average(:score).map{|k,v| [WordleTweet.flag_by_type(k),v] } %>



  

</table>

<%#= column_chart WordleTweet.group_by_day_of_week(:created_at, format: "%a").count %>

<h2>Wordle Tweet stats</h2>

<div >
Count [per type]
<%= column_chart WordleTweet.group(:wordle_type).sum(1) %>
</div>
<div >
Count [per type] excluding English Wordle (most popular)
<%= column_chart WordleTweet.group(:wordle_type).where.not(wordle_type: "wordle_en").count%>
</div>

<!-- non va 
<div >
https://stackoverflow.com/questions/55012763/how-to-setup-logarithmic-axis-for-line-chart-in-rails-chartkick
Count [per type] logarithmic
<%= line_chart(
  WordleTweet.group(:wordle_type).sum(1) ,
  library: {
          legend: {
              position: 'bottom',
          },
          scales: {
              yAxes: [
                  {
                      id: 'y-axis',
                        type: 'logarithmic'
                  },]
          }
      }
)
%>
</div>
-->


<%#= line_chart WordleTweet.all.map { |wt|
    {
     name: wt.wordle_type, 
     data: 
        #[42,42,42,42] # wt.group_by(:score).count
         WordleTweet.all.map{|wt| wt.score } + 42
    }
} rescue "Error #{$!}"%>

</div>
